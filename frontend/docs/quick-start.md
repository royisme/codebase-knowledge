# CIT Knowledge Graph Console 快速开始指南

## 概述

CIT Knowledge Graph Console 是一个企业级知识图谱管理平台，提供智能检索增强生成（RAG）功能，帮助用户快速从代码库、文档和知识图谱中获取所需信息。

## RAG 控制台功能

### 核心特性

- **智能问答**: 基于大语言模型的知识检索和问答
- **证据溯源**: 每个回答都提供具体的代码、文档或日志证据
- **会话管理**: 支持多个对话会话，便于组织和回顾
- **实时搜索**: 全文搜索历史对话和知识库内容
- **三栏布局**: 左侧会话列表、中间对话界面、右侧证据面板

### 使用场景

1. **代码问题排查**: 快速定位错误原因和解决方案
2. **架构理解**: 查询系统组件关系和设计模式
3. **知识学习**: 从项目文档和代码中学习最佳实践
4. **故障诊断**: 分析日志和配置文件定位问题

## 快速开始

### 前置要求

- Node.js 18+ 或 Bun 1.3+
- 现代浏览器（Chrome 90+, Firefox 88+, Safari 14+）

### 启动应用

1. **克隆项目**
   ```bash
   git clone <repository-url>
   cd nau-works/693
   ```

2. **安装依赖**
   ```bash
   bun install --cwd apps/frontend
   ```

3. **启动开发服务器**
   ```bash
   bun run --cwd apps/frontend dev
   ```

4. **访问应用**

   打开浏览器访问: http://localhost:5173

### 登录系统

1. 访问 `/sign-in` 页面
2. 使用以下任一账号登录：
   - **管理员**: admin@example.com / admin123
   - **普通用户**: user@example.com / user123

### 访问 RAG 控制台

1. 登录成功后，在左侧导航栏点击 "RAG 控制台"
2. 或直接访问: http://localhost:5173/rag-console

## RAG 控制台使用指南

### 界面布局

```
┌─────────────────┬─────────────────────────┬─────────────────┐
│   会话列表      │      对话界面            │   证据面板       │
│                │                        │                │
│ • 搜索框        │ • 会话标题              │ • 证据来源       │
│ • 新建会话      │ • 历史对话              │ • 文件路径       │
│ • 会话列表      │ • 输入框                │ • 相关度评分     │
│                │ • 发送按钮              │ • 资源类型       │
│                │                        │                │
└─────────────────┴─────────────────────────┴─────────────────┘
```

### 基本操作

#### 1. 开始新对话

**方法一**: 使用问题快速创建
1. 在中间对话区域输入您的问题
2. 点击发送按钮（或按 Enter）
3. 系统自动创建新会话并生成回答

**方法二**: 先创建会话再提问
1. 点击左侧"新建"按钮
2. 输入会话标题（可选）
3. 在对话区域输入问题

#### 2. 切换会话

- 点击左侧会话列表中的任意会话
- 系统立即切换到选中的会话
- 保留每个会话的完整对话历史

#### 3. 搜索会话

- 在左侧搜索框输入关键词
- 支持按会话标题和对话内容搜索
- 实时过滤显示匹配的会话

#### 4. 查看证据

- 每个AI回答都会在右侧证据面板显示相关证据
- 点击证据卡片查看详细信息
- 证据包含：
  - 文件路径和名称
  - 相关度评分（百分比）
  - 资源类型（代码、文档、日志等）

### 示例对话

#### 问题排查示例

**用户**: "解析管道最新的失败原因是什么？"

**AI**: "最近一次失败发生在 2025-01-18T23:10Z，原因是 Neo4j 写入超时。系统检测到超时后自动重试了3次，最终在第4次尝试时成功写入。建议优化 Neo4j 的批量写入配置以避免类似问题。"

**证据**:
- 任务执行日志 #TASK-2025-0118-2310 (94%)
- Neo4j 配置文件 neo4j.conf (89%)
- 数据管道错误处理代码 (86%)

#### 架构查询示例

**用户**: "显示所有与'用户认证'相关的组件"

**AI**: "找到了 8 个与用户认证相关的核心组件：1. AuthProvider - 认证状态管理 2. LoginModal - 登录弹窗组件 3. UserSession - 会话管理 4. TokenManager - JWT 令牌处理 5. PermissionGuard - 权限守卫组件 6. RBACService - 基于角色的访问控制 7. AuthAPI - 认证接口封装 8. PasswordValidator - 密码验证器"

**证据**:
- 认证上下文 AuthProvider (96%)
- 登录组件 LoginModal (93%)
- 权限管理 RBACService (91%)

## Mock 模式说明

当前版本运行在 Mock 模式下，提供以下演示功能：

### 预设会话

系统提供 5 个预设的演示会话：

1. **解析管道失败原因分析** - 展示错误排查能力
2. **用户认证系统架构查询** - 展示架构理解能力
3. **知识图谱构建流程** - 展示流程解释能力
4. **数据库查询性能优化** - 展示优化建议能力
5. **部署配置问题排查** - 展示故障诊断能力

### Mock 数据特点

- **真实性**: 基于真实项目结构生成
- **多样性**: 涵盖不同类型的技术问题
- **完整性**: 包含完整的对话和证据链
- **时效性**: 模拟最近的时间戳和活动

### API 响应模拟

- **延迟模拟**: AI 回复响应时间 1-3 秒
- **错误处理**: 模拟网络错误和系统异常
- **状态管理**: 支持会话创建、删除、更新
- **搜索功能**: 支持全文搜索和过滤

## 开发者信息

### 技术栈

- **前端**: React 19 + TypeScript + Vite
- **UI框架**: ShadcnUI + TailwindCSS
- **状态管理**: TanStack Query + Zustand
- **路由**: TanStack Router
- **Mock服务**: MSW (Mock Service Worker)
- **测试**: Vitest + Testing Library

### 项目结构

```
src/
├── features/rag-console/     # RAG 控制台功能模块
│   ├── components/          # UI 组件
│   ├── hooks/              # 自定义 Hooks
│   ├── services/           # API 服务
│   └── types/              # 类型定义
├── lib/api-mock/           # Mock 数据和服务
│   ├── fixtures/rag.ts     # RAG Mock 数据
│   └── handlers/rag.ts     # RAG API 处理器
└── routes/_authenticated/rag-console.tsx  # 路由页面
```

### Mock 数据定制

如需自定义 Mock 数据，请修改：
- `src/lib/api-mock/fixtures/rag.ts` - 数据内容
- `src/lib/api-mock/handlers/rag.ts` - API 逻辑

### 扩展功能

RAG 控制台支持以下扩展：
- 新增证据类型
- 自定义 AI 回复模板
- 集成真实的 GraphRAG API
- 添加更多搜索过滤器

## 故障排除

### 常见问题

**Q: 页面加载缓慢**
A: 首次加载需要初始化 Mock 数据，请等待 2-3 秒

**Q: 搜索无结果**
A: 确保搜索关键词准确，支持中英文搜索

**Q: AI 回复延迟**
A: Mock 模式模拟了真实 API 延迟（1-3秒）

**Q: 证据链接无效**
A: 当前为 Mock 模式，证据链接为演示用途

### 获取帮助

- 查看项目文档: `docs/` 目录
- 检查控制台错误信息
- 确认开发服务器正常运行

## 下一步

1. **后端集成**: 连接真实的 GraphRAG API 服务
2. **功能增强**: 添加文件上传、导出等功能
3. **性能优化**: 实现虚拟滚动和懒加载
4. **用户体验**: 添加更多交互细节和动画效果
5. **安全加固**: 实现权限控制和数据加密

---

*最后更新: 2025-01-24*
*版本: MVP 1.0*